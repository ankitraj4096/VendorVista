<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Ingredient Exchange | StreetSymphony Vendor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Poppins&display=swap" rel="stylesheet" />
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
  <style>
    :root {
      --primary: #58c061;
      --primary-dark: #357138;
      --secondary: #fffef7;
      --accent: #fbe27a;
      --card-bg: #f7fdf6;
      --border: #dbeadb;
      --text-dark: #232c1e;
      --text-light: #526a3b;
      --shadow: 0 6px 28px rgba(41, 88, 40, 0.12);
      --button: #26c485;
      --button-hover: #1fa471;
      --button-text: #fff;
      --sidebar-bg: #edfdef;
      --sidebar-highlight: #afd375;
      --sidebar-width: 220px;
    }
    body {
      margin: 0;
      padding: 0;
      background: var(--secondary);
      color: var(--text-dark);
      font-family: 'Poppins', Arial, sans-serif;
      display: flex;
      min-height: 100vh;
    }
    .sidebar {
      background: var(--sidebar-bg);
      width: var(--sidebar-width);
      min-width: 165px;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 32px 0 27px 0;
      border-right: 3px solid var(--border);
      position: sticky;
      top: 0;
      height: 100vh;
      box-shadow: 3px 0 22px #d6f2cd08;
      z-index: 11;
    }
    .sidebar .logo {
      font-family: 'Montserrat', sans-serif;
      font-size: 1.44rem;
      color: var(--primary-dark);
      font-weight: 900;
      letter-spacing: 1px;
      margin-bottom: 35px;
      display: flex;
      align-items: center;
      gap: 11px;
    }
    .sidebar nav {
      display: flex;
      flex-direction: column;
      width: 100%;
      gap: 7px;
      margin-bottom: 40px;
    }
    .nav-link {
      text-decoration: none;
      color: var(--text-dark);
      font-weight: 600;
      font-size: 1.07rem;
      padding: 13px 0px 13px 33px;
      border-radius: 0 26px 26px 0;
      background: none;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: background 0.12s, color 0.11s;
      position: relative;
    }
    .nav-link.active, .nav-link:hover {
      background: var(--sidebar-highlight);
      color: #fff;
    }
    .nav-link.active::before {
      content: '';
      width: 5px; height: 30px;
      background: var(--primary);
      position: absolute;
      left: 0; top: 11px; border-radius: 3px;
    }
    .sidebar .profile-short {
      margin-top: auto;
      padding-top: 16px;
      text-align: center;
      color: var(--text-light);
      font-size: 0.99rem;
      width: 160px;
    }
    main.dashboard {
      flex: 1;
      background: var(--secondary);
      padding: 30px 40px;
      overflow-y: auto;
      min-width: 0;
      max-width: 100vw;
    }
    header.dashboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 32px;
      max-width: 900px;
      flex-wrap: wrap;
      gap: 10px;
    }
    header.dashboard-header h1 {
      font-family: 'Montserrat', sans-serif;
      font-weight: 800;
      font-size: 2rem;
      color: var(--primary-dark);
      margin: 0;
    }
    button.add-exchange-btn {
      background: var(--primary);
      color: #fff;
      border: none;
      padding: 12px 34px;
      border-radius: 1.3em;
      font-weight: 700;
      font-size: 1.1rem;
      cursor: pointer;
      box-shadow: 0 3px 18px rgba(88, 192, 97, 0.14);
      transition: background 0.25s;
      white-space: nowrap;
    }
    button.add-exchange-btn:hover {
      background: var(--primary-dark);
    }

    .exchange-list {
      max-width: 900px;
      background: var(--card-bg);
      border-radius: 1.2em;
      box-shadow: var(--shadow);
      padding: 20px 25px 32px 25px;
      font-size: 1rem;
      color: var(--text-dark);
    }
    .exchange-item {
      border-bottom: 2px solid var(--border);
      padding: 16px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 18px;
      flex-wrap: wrap;
    }
    .exchange-item:last-child {
      border-bottom: none;
    }
    .exchange-details {
      flex-grow: 1;
      min-width: 220px;
    }
    .exchange-title {
      font-weight: 700;
      font-family: 'Montserrat', sans-serif;
      color: var(--primary-dark);
      font-size: 1.1rem;
      margin-bottom: 4px;
    }
    .exchange-desc {
      color: var(--text-light);
      font-size: 0.95rem;
      line-height: 1.4;
    }
    .exchange-meta {
      font-size: 0.9rem;
      color: var(--accent);
      font-weight: 700;
      font-family: 'Montserrat', sans-serif;
      margin-top: 6px;
    }
    .exchange-actions {
      display: flex;
      gap: 12px;
      flex-wrap: nowrap;
    }
    button.exchange-btn, button.reject-btn {
      padding: 7px 18px;
      border-radius: 1em;
      font-weight: 700;
      font-size: 0.94em;
      cursor: pointer;
      border: none;
      transition: background 0.2s, color 0.2s;
      min-width: 90px;
      white-space: nowrap;
    }
    button.exchange-btn {
      background-color: var(--button);
      color: var(--button-text);
      box-shadow: 0 2px 16px #26c48542;
    }
    button.exchange-btn:hover {
      background-color: var(--button-hover);
    }
    button.reject-btn {
      background-color: #e74c3c;
      color: #fff;
      box-shadow: 0 2px 16px #e74c3c88;
    }
    button.reject-btn:hover {
      background-color: #c0392b;
    }

    /* New Exchange Proposal Modal */
    .modal-backdrop {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(34,34,34,0.48);
      z-index: 500;
      justify-content: center;
      align-items: center;
    }
    .modal {
      background: var(--card-bg);
      padding: 24px 28px 28px 28px;
      border-radius: 1.2em;
      width: 400px;
      max-width: 95vw;
      box-shadow: var(--shadow);
      position: relative;
    }
    .modal h2 {
      font-family: 'Montserrat', sans-serif;
      font-weight: 700;
      font-size: 1.5rem;
      margin-top: 0;
      color: var(--primary-dark);
      margin-bottom: 18px;
    }
    .modal label {
      display: block;
      font-weight: 600;
      font-size: 1rem;
      margin-bottom: 6px;
      color: var(--text-dark);
    }
    .modal input[type="text"], .modal textarea {
      width: 100%;
      padding: 9px 12px;
      border-radius: 0.9em;
      border: 1.6px solid var(--border);
      font-size: 1rem;
      font-family: inherit;
      resize: vertical;
      color: var(--text-dark);
      margin-bottom: 16px;
      box-sizing: border-box;
    }
    .modal textarea {
      min-height: 72px;
    }
    .modal-buttons {
      display: flex;
      justify-content: flex-end;
      gap: 15px;
    }
    .btn-cancel {
      background: #bbb;
      border: none;
      color: #333;
      border-radius: 1.1em;
      padding: 10px 24px;
      font-weight: 700;
      cursor: pointer;
      transition: background 0.22s;
    }
    .btn-cancel:hover {
      background: #999;
    }
    .btn-submit {
      background: var(--primary);
      border: none;
      color: #fff;
      border-radius: 1.1em;
      padding: 10px 28px;
      font-weight: 700;
      cursor: pointer;
      transition: background 0.22s;
    }
    .btn-submit:hover {
      background: var(--primary-dark);
    }

    @media (max-width: 600px) {
      .exchange-item {
        flex-direction: column;
        align-items: flex-start;
      }
      .exchange-actions {
        width: 100%;
        justify-content: start;
        gap: 10px;
        margin-top: 12px;
      }
    }
  </style>
</head>
<body>
  <aside class="sidebar">
    <div class="logo">
      <i class="bi bi-shop-window"></i> StreetSymphony
    </div>
    <nav>
      <a href="vendor-dashboard.html" class="nav-link">Dashboard</a>
      <a href="vendor-orders.html" class="nav-link">Orders</a>
      <a href="vendor-exchange.html" class="nav-link active">Exchange</a>
      <a href="vendor-stories.html" class="nav-link">Stories</a>
      <a href="shared-profile.html" class="nav-link">Profile</a>
    </nav>
    <div class="profile-short">
      <div><b>Sharma Chaat</b></div>
      <div style="font-size:.97em; margin-top:5px;">
        <span style="color:var(--primary);">Vendor</span><br />
        <span style="font-size:1.25em;">ðŸŸ¢</span> Online Now
      </div>
    </div>
  </aside>

  <main class="dashboard" role="main">
    <header class="dashboard-header">
      <h1>Ingredient Exchange</h1>
      <button class="add-exchange-btn" id="openModalBtn"><i class="bi bi-plus-circle"></i> Propose New Swap</button>
    </header>

    <section class="exchange-list" aria-live="polite" aria-label="List of current exchange offers and requests" id="exchangeList">
      <!-- Exchange Items dynamically inserted here -->
    </section>
  </main>

  <!-- Modal for New Swap Proposal -->
  <div class="modal-backdrop" id="modalBackdrop" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-describedby="modalDesc">
    <div class="modal" role="document">
      <h2 id="modalTitle">New Ingredient Swap Proposal</h2>
      <form id="exchangeForm">
        <label for="needInput">Need (Ingredient, Qty)</label>
        <input id="needInput" type="text" name="need" placeholder="e.g., Tomatoes 5kg" required />

        <label for="offerInput">Offer (Ingredient, Qty)</label>
        <input id="offerInput" type="text" name="offer" placeholder="e.g., Potatoes 3kg" required />

        <label for="notesInput">Additional Notes (optional)</label>
        <textarea id="notesInput" name="notes" placeholder="Any details or conditions..."></textarea>

        <div class="modal-buttons">
          <button type="button" class="btn-cancel" id="modalCancelBtn">Cancel</button>
          <button type="submit" class="btn-submit">Submit Proposal</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    // Sample exchange data (representing exchanges with nearby vendors)
    const exchangeData = [
      {
        id: 1,
        need: 'Onions 2kg',
        offer: 'Mint Leaves 1kg',
        notes: 'Fresh and organic, from Gupta Sweets',
      },
      {
        id: 2,
        need: 'Tomatoes 4kg',
        offer: 'Boiled Potatoes 3kg',
        notes: 'High quality, harvested yesterday',
      },
      {
        id: 3,
        need: 'Chopped Coriander 1.5kg',
        offer: 'Green Chillies 0.5kg',
        notes: 'Exchange available immediately',
      }
    ];

    const exchangeListEl = document.getElementById('exchangeList');
    const modalBackdrop = document.getElementById('modalBackdrop');
    const openModalBtn = document.getElementById('openModalBtn');
    const modalCancelBtn = document.getElementById('modalCancelBtn');
    const exchangeForm = document.getElementById('exchangeForm');

    function renderExchangeList() {
      exchangeListEl.innerHTML = '';
      if (exchangeData.length === 0) {
        exchangeListEl.innerHTML = '<p>No exchange offers currently available. Propose one!</p>';
        return;
      }

      exchangeData.forEach(item => {
        const itemEl = document.createElement('div');
        itemEl.classList.add('exchange-item');

        itemEl.innerHTML = `
          <div class="exchange-details">
            <div class="exchange-title"><strong>Need:</strong> ${item.need}</div>
            <div class="exchange-desc"><strong>Offer:</strong> ${item.offer}</div>
            ${item.notes ? `<div class="exchange-meta">${item.notes}</div>` : ''}
          </div>
          <div class="exchange-actions">
            <button class="exchange-btn" title="Propose swap with sender">Propose Swap</button>
            <button class="reject-btn" title="Reject offer">Reject</button>
          </div>
        `;

        const proposeBtn = itemEl.querySelector('.exchange-btn');
        const rejectBtn = itemEl.querySelector('.reject-btn');

        proposeBtn.addEventListener('click', () => {
          alert(`Swap proposal sent for: Need "${item.need}", Offer "${item.offer}"`);
        });
        rejectBtn.addEventListener('click', () => {
          if(confirm('Are you sure you want to reject this exchange offer?')) {
            // Remove from data and re-render (in real app, notify backend)
            const index = exchangeData.findIndex(e => e.id === item.id);
            if(index !== -1) {
              exchangeData.splice(index, 1);
              renderExchangeList();
            }
          }
        });

        exchangeListEl.appendChild(itemEl);
      });
    }

    // Modal open/close handlers
    openModalBtn.addEventListener('click', () => {
      modalBackdrop.style.display = 'flex';
      document.getElementById('needInput').focus();
    });
    modalCancelBtn.addEventListener('click', () => {
      modalBackdrop.style.display = 'none';
      exchangeForm.reset();
    });
    modalBackdrop.addEventListener('click', e => {
      if(e.target === modalBackdrop){
        modalBackdrop.style.display = 'none';
        exchangeForm.reset();
      }
    });

    // Handle form submit for new proposal
    exchangeForm.addEventListener('submit', e => {
      e.preventDefault();
      const need = e.target.need.value.trim();
      const offer = e.target.offer.value.trim();
      const notes = e.target.notes.value.trim();

      if(need && offer) {
        const newProposal = {
          id: Date.now(),
          need,
          offer,
          notes
        };
        exchangeData.push(newProposal);
        renderExchangeList();

        modalBackdrop.style.display = 'none';
        exchangeForm.reset();
        alert('New swap proposal submitted!');
      }
    });

    // Initial render
    renderExchangeList();
  </script>
</body>
</html>
